# Ralph Progress Log
Started: 2026-02-07
Project: VETTR Android
---

## Codebase Patterns
- All ViewModels use @HiltViewModel with @Inject constructor and StateFlow for UI state
- Compose screens use collectAsStateWithLifecycle() for state collection
- Room entities use @Entity annotation with @PrimaryKey
- Hilt modules use @Module + @InstallIn(SingletonComponent::class)
- Design tokens in designsystem/theme/ - NEVER hardcode colors or fonts
- Navigation uses Navigation Compose with sealed class routes
- JAVA_HOME must point to Android Studio JBR: /Applications/Android Studio.app/Contents/jbr/Contents/Home
- Build command: JAVA_HOME="/Applications/Android Studio.app/Contents/jbr/Contents/Home" ./gradlew assembleDebug
---

## US-001: Verify minSdk 26 and compileSdk 35 configuration
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Updated app/build.gradle.kts: compileSdk 36 → 35, targetSdk 36 → 35
- Verified minSdk = 26 (already correct)
- Verified Java 17 compatibility (already correct)
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - JAVA_HOME must be set to Android Studio JBR for builds
  - Use sed for PRD updates: `sed -i '' 's/"passes": false/"passes": true/' prd.json` within story context
  - Build warnings about deprecated statusBarColor/navigationBarColor are expected (deprecated in API)
---
## US-002: Create package folder structure
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core packages: core/, core/model/, core/data/, core/data/local/, core/data/remote/, core/data/repository/, core/di/, core/util/
- Created designsystem packages: designsystem/component/, designsystem/icon/
- Created feature packages: feature/auth/, feature/pulse/, feature/discovery/, feature/stockdetail/, feature/alerts/, feature/profile/, feature/main/
- Added .gitkeep files to all 18 new directories for Git tracking
- Verified build: ./gradlew assembleDebug succeeds
**Learnings for future iterations:**
  - Use `find ... -type d -exec touch {}/.gitkeep \;` to add .gitkeep files to multiple directories efficiently
  - Package structure follows clean architecture: core (data/business logic), designsystem (UI components), feature (screens)
  - .gitkeep files are necessary to track empty directories in Git
---
## US-003: Verify Hilt dependency injection setup
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Verified @HiltAndroidApp annotation on VettrApp (VettrApp.kt:6)
- Verified @AndroidEntryPoint annotation on MainActivity (MainActivity.kt:19)
- Verified hilt-android and hilt-android-compiler dependencies (build.gradle.kts:84-85)
- Verified ksp plugin applied (build.gradle.kts:6)
- Verified VettrApp registered in AndroidManifest.xml (android:name=".VettrApp")
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Hilt was already properly configured in the initial scaffold
  - Key Hilt setup components: @HiltAndroidApp on Application, @AndroidEntryPoint on Activity, ksp plugin for annotation processing
  - Hilt version 2.53.1 with androidx.hilt:hilt-navigation-compose 1.2.0 for Compose integration
  - ksp tasks (kspDebugKotlin, hiltAggregateDepsDebug, hiltJavaCompileDebug) run automatically during build
---
## US-004: Verify Room database dependencies
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Verified room-runtime, room-ktx, and room-compiler (ksp) dependencies in build.gradle.kts (lines 76-78)
- Verified KSP plugin applied in build.gradle.kts (line 6)
- Created VettrDatabase abstract class in core/data/local/VettrDatabase.kt
- Created PlaceholderEntity in core/model/PlaceholderEntity.kt (Room requires at least one entity in @Database annotation)
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Room @Database annotation requires at least one entity in entities array - empty array causes KSP compilation error
  - Created placeholder entity PlaceholderEntity to satisfy Room requirement until real entities are added
  - Room dependencies were already properly configured in initial scaffold (room-runtime, room-ktx, room-compiler with ksp)
  - VettrDatabase will be used as the single source of truth for local data persistence
---
## US-005: Verify Retrofit and OkHttp networking dependencies
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Verified retrofit and retrofit-converter-gson dependencies (version 2.11.0) in app/build.gradle.kts:89-90
- Verified okhttp and okhttp-logging-interceptor dependencies (version 4.12.0) in app/build.gradle.kts:91-92
- Verified kotlinx-coroutines-android and kotlinx-coroutines-core dependencies (version 1.9.0) in app/build.gradle.kts:99-100
- All dependencies properly defined in gradle/libs.versions.toml version catalog
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Networking dependencies were already properly configured in the initial scaffold
  - Retrofit 2.11.0 provides type-safe HTTP client with Gson converter for JSON serialization
  - OkHttp 4.12.0 provides HTTP client with logging interceptor for debugging network calls
  - Coroutines 1.9.0 enables suspend functions for asynchronous networking operations
  - Version catalog pattern (libs.versions.toml) centralizes dependency version management
---
## US-006: Verify Coil image loading dependency
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Verified coil-compose and coil-network-okhttp dependencies in app/build.gradle.kts (lines 95-96)
- Verified Coil version 3.0.4 in gradle/libs.versions.toml
- Created CoilVerification.kt in core/util/ with AsyncImage composable to verify import compiles
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Coil 3.x uses coil3.compose.AsyncImage (not coil.compose.AsyncImage from v2)
  - Coil dependencies were already properly configured in the initial scaffold
  - Coil 3.0.4 with coil-network-okhttp provides efficient image loading with OkHttp backend
  - AsyncImage is the primary composable for loading images in Jetpack Compose
---
## US-007: Add Google Sign-In dependency
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Added Google Sign-In and Credentials API dependencies to gradle/libs.versions.toml
- Added play-services-auth version 21.2.0
- Added googleid version 1.1.1
- Added androidx.credentials version 1.5.0
- Added androidx.credentials-play-services-auth version 1.5.0
- Updated app/build.gradle.kts to include all four dependencies
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Google Sign-In now uses Credentials API (androidx.credentials) for modern authentication
  - Four dependencies required: play-services-auth, googleid, credentials, and credentials-play-services-auth
  - Google Sign-In One Tap requires both the legacy play-services-auth and new Credentials API libraries
  - Version catalog pattern in libs.versions.toml allows centralized dependency management
---
## US-008: Add EncryptedSharedPreferences dependency
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Added androidx.security:security-crypto version 1.1.0-alpha06 to gradle/libs.versions.toml
- Added security-crypto dependency to app/build.gradle.kts
- Created EncryptedPreferencesVerification.kt to verify import compiles
- Verified EncryptedSharedPreferences and MasterKey imports work correctly
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - androidx.security:security-crypto provides EncryptedSharedPreferences for secure local storage
  - Version 1.1.0-alpha06 is the latest stable alpha with AES256_GCM encryption scheme
  - MasterKey.Builder with AES256_GCM is recommended for creating encryption keys
  - EncryptedSharedPreferences will be used for storing OAuth tokens, API keys, and sensitive user data
  - Verification pattern: create a utility object with example usage to confirm imports compile
---
## US-009: Add WorkManager dependency for background tasks
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Added WorkManager version 2.10.0 to gradle/libs.versions.toml
- Added Hilt WorkManager integration version 1.2.0 to gradle/libs.versions.toml
- Added androidx.work:work-runtime-ktx dependency to app/build.gradle.kts
- Added androidx.hilt:hilt-work dependencies (implementation and ksp) to app/build.gradle.kts
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - WorkManager requires two dependencies: work-runtime-ktx for core functionality and hilt-work for Hilt integration
  - Hilt WorkManager integration requires both implementation and ksp (annotation processing) dependencies
  - WorkManager 2.10.0 is the latest stable version for reliable background task scheduling
  - WorkManager will be used for periodic data sync, such as fetching stock prices, filings, and alerts
  - androidx.hilt:hilt-work enables @HiltWorker annotation for dependency injection in Worker classes
---

## US-010: Add BiometricPrompt dependency
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Added androidx.biometric:biometric dependency (version 1.4.0-alpha02) to build.gradle.kts
- Added biometric version to gradle/libs.versions.toml version catalog
- Added androidx-biometric library reference to libs.versions.toml
- Verified that import androidx.biometric.BiometricPrompt compiles successfully
- Build passes: ./gradlew assembleDebug completes successfully
Files changed:
- gradle/libs.versions.toml (added biometric version and library)
- app/build.gradle.kts (added BiometricPrompt implementation dependency)

**Learnings for future iterations:**
- BiometricPrompt is part of androidx.biometric library, standard for fingerprint and face authentication
- Version 1.4.0-alpha02 is the latest stable alpha release as of early 2026
- Following the established pattern of using version catalog for all dependencies maintains consistency
- BiometricPrompt will be used for secure authentication alongside Google Sign-In
---
## US-011: Create .gitignore for Android project
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Verified .gitignore already contains all required entries from acceptance criteria
- .gitignore includes: .gradle/, build/, .idea/, *.iml, local.properties, .DS_Store, captures/, .externalNativeBuild/, .cxx/
- Verified git status --ignored shows no tracked files in ignore list (all properly excluded)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- .gitignore was already properly configured in the initial project scaffold
**Learnings for future iterations:**
  - The initial project scaffold included a comprehensive .gitignore file
  - git status --ignored command is useful to verify ignored files aren't being tracked
  - Android projects typically ignore: build artifacts (.gradle/, build/, *.iml), IDE files (.idea/), local config (local.properties), OS files (.DS_Store), native build outputs (.externalNativeBuild/, .cxx/), and profiling data (*.hprof)
---

## US-012: Create GitHub Actions workflow for build and test
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created .github/workflows/build.yml with CI configuration
- Workflow triggers on push and pull_request to main branch
- Uses ubuntu-latest runner with JDK 17 (temurin distribution)
- Includes gradle cache for faster builds
- Runs ./gradlew assembleDebug to build the app
- Runs ./gradlew testDebugUnitTest to execute unit tests
- YAML validation confirmed with Python yaml parser
- Build successful: ./gradlew assembleDebug passes
Files changed:
- .github/workflows/build.yml (created)
**Learnings for future iterations:**
  - GitHub Actions uses actions/checkout@v4 for checking out code
  - actions/setup-java@v4 with 'temurin' distribution provides reliable JDK 17
  - gradle cache in setup-java action speeds up subsequent workflow runs
  - chmod +x gradlew step ensures gradlew is executable on CI runners
  - Workflow YAML syntax can be validated with Python's yaml.safe_load()
  - CI workflow mirrors local build commands: assembleDebug and testDebugUnitTest
---

## US-013: Create Color.kt with brand design tokens
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Updated designsystem/theme/Color.kt with VETTR brand design tokens
- Verified all required colors present: VettrNavy (0xFF0D1B2A), VettrAccent (0xFF00C853), VettrCardBackground (0xFF1B2838)
- Updated VettrTextPrimary to use Color.White for consistency (same as 0xFFFFFFFF)
- Added risk indicator colors: VettrGreen (0xFF00C853), VettrYellow (0xFFFFAB00), VettrRed (0xFFFF5252)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/theme/Color.kt
**Learnings for future iterations:**
  - Color.kt file already had most brand colors defined in the initial scaffold
  - Risk indicator colors (VettrGreen, VettrYellow, VettrRed) are essential for score/change indicators throughout the app
  - Using Color.White is more idiomatic than 0xFFFFFFFF for white color definitions
  - VettrGreen and VettrAccent share the same color value (0xFF00C853) as they both represent positive/primary actions
  - Color definitions follow the pattern: brand colors, surface hierarchy, semantic colors, on-colors, risk indicators
---


## US-014: Create Typography.kt with text styles
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Updated designsystem/theme/Type.kt with VETTR typography specifications
- Updated displayLarge: 34sp, Bold (was 57sp)
- Updated titleLarge: 28sp, SemiBold (was 22sp)
- Updated titleMedium: 20sp, SemiBold (was 16sp, Medium)
- Updated bodyLarge: 17sp, Normal (was 16sp)
- Updated bodyMedium: 15sp, Normal (was 14sp)
- Updated labelSmall: 12sp, Normal (was 11sp, Medium)
- All text styles use FontFamily.Default (system font)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/theme/Type.kt
**Learnings for future iterations:**
  - Type.kt file already had complete Material3 Typography structure in place from initial scaffold
  - Updated 6 specific text styles to match VETTR design specifications while keeping other Material3 styles intact
  - FontFamily.Default provides system font (SF Pro on iOS-style designs, Roboto on Android)
  - Material3 Typography includes comprehensive set of text styles: displayLarge/Medium/Small, headlineLarge/Medium/Small, titleLarge/Medium/Small, bodyLarge/Medium/Small, labelLarge/Medium/Small
  - Line heights should scale proportionally with font sizes for optimal readability
---

## US-015: Create Spacing.kt and Dimensions.kt constants
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/theme/Spacing.kt with spacing constants: xs=4.dp, sm=8.dp, md=16.dp, lg=24.dp, xl=32.dp
- Created designsystem/theme/Dimensions.kt with dimension constants
- Added corner radii: cardRadius=12.dp, chipRadius=20.dp, buttonRadius=8.dp
- Added icon sizes: iconSm=16.dp, iconMd=24.dp, iconLg=32.dp
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/theme/Spacing.kt (created)
- app/src/main/java/com/vettr/android/designsystem/theme/Dimensions.kt (created)
**Learnings for future iterations:**
  - Spacing and Dimensions objects provide centralized design token constants for consistent UI
  - Using Dp type from androidx.compose.ui.unit ensures proper density-independent sizing
  - Spacing follows a modular scale: xs(4dp), sm(8dp), md(16dp), lg(24dp), xl(32dp)
  - Corner radii vary by component: cards(12dp), chips(20dp), buttons(8dp) for visual hierarchy
  - Icon sizes follow standard Material guidelines: sm(16dp), md(24dp), lg(32dp)
  - These design tokens should be used throughout the app instead of hardcoding dimension values
---

## US-016: Update VettrTheme with complete Material3 theme
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Verified VettrTheme composable already configured with darkColorScheme
- Verified darkColorScheme uses VettrNavy as background (line 27), VettrAccent as primary (line 13), and VettrCardBackground as surfaceContainerHighest (line 37)
- Verified dark mode is forced: hardcoded `VettrDarkColorScheme` with no system theme detection (line 50)
- Added @Preview composable (VettrThemePreview) showing theme applied to sample content with Text and Card components
- Added required imports for Preview: androidx.compose.ui.tooling.preview.Preview, foundation components
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/theme/Theme.kt (added imports and VettrThemePreview)
**Learnings for future iterations:**
  - VettrTheme was already fully configured with Material3 darkColorScheme in the initial scaffold
  - The theme properly maps VETTR brand colors: VettrNavy (background), VettrAccent (primary), VettrCardBackground (surface)
  - Dark mode is enforced by hardcoding VettrDarkColorScheme without system theme parameter
  - Preview composables are essential for design system validation in Android Studio
  - Material3 colorScheme includes comprehensive surface hierarchy: surface, surfaceVariant, surfaceContainer variants for different elevations
  - SideEffect with WindowCompat sets status bar and navigation bar to dark mode (isAppearanceLightStatusBars = false)
---

## US-017: Create Modifier extensions for design system
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/ModifierExtensions.kt with reusable Modifier extensions
- Added Modifier.cardStyle() extension: applies VettrCardBackground, RoundedCornerShape(12.dp), and shadow(2.dp)
- Added Modifier.vettrPadding() extension: applies padding with default Spacing.md (16.dp)
- Added two @Preview composables: CardStylePreview and VettrPaddingPreview demonstrating usage
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/ModifierExtensions.kt (created)
**Learnings for future iterations:**
  - Modifier extensions provide reusable styling patterns that promote consistency across the app
  - cardStyle() applies all card styling in correct order: shadow first (before clip), then clip, then background
  - The shadow must be applied before clip() to ensure the elevation effect is visible
  - vettrPadding() provides a convenient way to use standard spacing tokens with customization option
  - Preview composables with showBackground and backgroundColor help visualize dark theme components in Android Studio
  - Modifier extension functions follow Kotlin convention: they are top-level functions that extend Modifier and return Modifier
  - Design token objects (Spacing, Dimensions, VettrCardBackground) ensure all styling uses centralized values
---
## US-018: Create VettrScoreView composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/VettrScoreView.kt with circular badge component
- Implemented Canvas-based circular score display with progress arc (0-360 degrees)
- Added color-coded scoring: VettrGreen (>80 Strong Buy), VettrYellow (60-80 Buy), Orange (40-60 Hold), VettrRed (<40 Caution)
- Added descriptive labels below score: Strong Buy, Buy, Hold, Caution
- Created 4 @Preview composables for different score ranges: 85, 70, 50, 30
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/VettrScoreView.kt (created)
**Learnings for future iterations:**
  - Canvas drawContext.canvas.nativeCanvas is not available in Compose Multiplatform/modern Compose APIs
  - Use Box with Canvas for drawing and Text composable for text overlay instead of native canvas text
  - Canvas drawArc with startAngle=-90f starts from top (12 o'clock position) for intuitive circular progress
  - Color-coded scoring system requires clear thresholds: >80 (green), 60-80 (yellow), 40-60 (orange), <40 (red)
  - Text composable with MaterialTheme.typography.displaySmall works well for centered score display
  - Background circle with gray color (0xFF3A4A5A) provides visual track for progress arc
  - StrokeCap.Round on arc creates polished, modern circular progress appearance
---
## US-019: Create MetricCard composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/MetricCard.kt with @Composable function
- Parameters: title (String), value (String), change (Double?, optional)
- Displays title with bodyMedium typography in onSurfaceVariant color
- Displays value with titleLarge typography in onSurface color
- Optional change indicator shows +/- prefix with color coding (VettrGreen for positive, VettrRed for negative)
- Uses Modifier.cardStyle() extension for consistent card styling
- Uses Modifier.vettrPadding() extension with Spacing.md for consistent padding
- Added 4 @Preview composables: positive change (+5.25%), negative change (-2.15%), no change, and zero change (0.0%)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/MetricCard.kt (created)
**Learnings for future iterations:**
  - MetricCard provides consistent format for displaying key metrics across the app (market cap, price, volume, etc.)
  - Change indicator uses color coding for instant visual feedback: green for positive, red for negative
  - String.format("%.2f", change) formats percentage to 2 decimal places
  - Zero change (0.0) is treated as positive, displaying "+0.00%" in green
  - Multiple preview composables help validate component appearance for different data states
  - Arrangement.spacedBy(Spacing.xs) provides consistent vertical spacing between title, value, and change
  - Using MaterialTheme.colorScheme colors ensures proper contrast in dark theme
---

## US-020: Create SectorChip composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/SectorChip.kt @Composable function
- Implemented pill-shaped Surface with RoundedCornerShape(Dimensions.chipRadius) = 20.dp
- Applied VettrCardBackground color with 1.dp VettrAccent border
- Uses labelSmall typography with compact padding (horizontal: Spacing.md, vertical: Spacing.sm)
- Added 3 @Preview composables: Mining, Technology, Energy sectors
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/SectorChip.kt (created)
**Learnings for future iterations:**
  - SectorChip provides consistent sector tag styling across the app (stock lists, detail screens, etc.)
  - Using Dimensions.chipRadius (20.dp) creates perfect pill shape for compact tags
  - Border modifier must be applied before Surface to ensure border is visible on the Surface shape
  - labelSmall typography (12sp) is optimal for compact tag text readability
  - Preview composables with dark background (0xFF0D1B2A) help visualize components in the dark theme
  - Horizontal padding (Spacing.md = 16.dp) and vertical padding (Spacing.sm = 8.dp) provide balanced visual weight for chip
---

## US-021: Create StockRowView composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/StockRowView.kt @Composable function
- Parameters: ticker, companyName, price, priceChange, logoUrl, onClick
- Displays ticker and company name in left column with ticker in titleMedium and company name in bodyMedium
- Displays price and price change in right column, both right-aligned
- Uses AsyncImage from Coil for company logo with 48.dp circular shape
- Price change color-coded: VettrGreen for positive/zero, VettrRed for negative
- Price change displays with +/- prefix and dollar sign (e.g., "+$2.35" or "-$1.45")
- Row is clickable with onClick callback
- Added 4 @Preview composables: positive change (SHOP), negative change (RY), zero change (ENB), no logo (TD)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/StockRowView.kt (created)
**Learnings for future iterations:**
  - StockRowView provides consistent stock list item format for Pulse, Discovery, and Watchlist screens
  - AsyncImage from Coil 3.x handles logo loading with contentDescription for accessibility
  - Using Modifier.weight(1f) on ticker/company column allows price column to stay right-aligned
  - Circular logo shape (CircleShape with clip) creates professional appearance for company logos
  - Column with Alignment.End for price/change ensures proper right alignment
  - Price formatting uses String.format("$%.2f", price) for consistent 2-decimal display
  - Clickable modifier applied to entire row enables navigation to stock detail screen
  - Real stock examples (Canadian stocks like SHOP, RY, ENB, TD) provide realistic preview data
---

## US-022: Create SearchBarView composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/SearchBarView.kt @Composable function
- Implemented OutlinedTextField with Icons.Default.Search leading icon
- Parameters: query (String), onQueryChange ((String) -> Unit)
- Used VettrCardBackground for container color with dark theme styling
- Added placeholder text "Search" with onSurfaceVariant color
- Set colors for focused/unfocused border states with primary accent on focus
- Made text field single line for optimal search input
- Added 2 @Preview composables: empty state and populated state (query: "Shopify")
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/SearchBarView.kt (created)
**Learnings for future iterations:**
  - OutlinedTextField requires OutlinedTextFieldDefaults.colors() for custom dark theme styling
  - VettrCardBackground (0xFF1B2838) provides proper contrast for text input on dark VettrNavy background
  - leadingIcon parameter takes composable lambda, perfect for Material Icons
  - textStyle parameter allows customization of input text appearance (color, typography)
  - singleLine = true prevents multi-line search input and improves UX
  - Placeholder uses onSurfaceVariant color for subtle hint text that doesn't distract
  - Border colors use alpha transparency (0.5f) for unfocused state to reduce visual weight
---
## US-023: Create SectionHeader composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/SectionHeader.kt @Composable function
- Implemented Row layout with SpaceBetween arrangement for title and optional "See All" button
- Uses titleMedium typography for section title text
- Optional TextButton with "See All" text appears only when onSeeAllClick callback is provided
- Added 2 @Preview composables: SectionHeaderPreview (without See All) and SectionHeaderWithSeeAllPreview (with See All button)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/SectionHeader.kt (created)
**Learnings for future iterations:**
  - SectionHeader provides consistent section header styling across all screens (Pulse, Discovery, Alerts, etc.)
  - Using Row with Arrangement.SpaceBetween automatically places title on left and "See All" button on right
  - TextButton is the Material3 component for text-only clickable actions, perfect for "See All" links
  - Conditional rendering (if onSeeAllClick != null) allows component to work with or without the action button
  - Preview composables with dark background (0xFF0D1B2A) demonstrate component in the VETTR dark theme
  - titleMedium typography (20sp, SemiBold) provides proper visual hierarchy for section headers
---

## US-024: Create LoadingView composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/LoadingView.kt @Composable function
- Implemented centered Box with CircularProgressIndicator using VettrAccent color
- Added optional message parameter that displays Text below spinner when provided
- Used Column with vertical spacing (Spacing.md) to arrange spinner and message
- Added 2 @Preview composables: LoadingViewPreview (no message) and LoadingViewWithMessagePreview (with message)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/LoadingView.kt (created)
**Learnings for future iterations:**
  - LoadingView provides consistent loading indicator throughout app for data fetching states
  - CircularProgressIndicator with VettrAccent color maintains brand consistency
  - Optional message parameter adds flexibility for contextual loading messages (e.g., "Loading stocks...", "Syncing data...")
  - Box with fillMaxSize and Center alignment ensures spinner is properly centered on screen
  - Column with Arrangement.spacedBy provides consistent spacing between spinner and message text
  - Using MaterialTheme.colorScheme.onSurfaceVariant for message text ensures proper contrast in dark theme
  - Preview composables with dark background (0xFF0D1B2A) validate appearance in VETTR dark theme
---

## US-025: Create ErrorView composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/ErrorView.kt @Composable function
- Displays red error icon (Icons.Default.Error), error message text, and Retry button
- Parameters: message: String, onRetry: () -> Unit
- Used Material3 Button with VettrAccent background and white text for Retry button
- Centered layout with Box, vertical arrangement with Column
- Added @Preview composable with sample error message
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/ErrorView.kt (created)
**Learnings for future iterations:**
  - ErrorView provides consistent error state handling across all screens with retry capability
  - Uses Icons.Default.Error from Material Icons with VettrRed tint for visual error indication
  - Material3 Button with ButtonDefaults.buttonColors() allows customization of container and content colors
  - Box with fillMaxSize and Center alignment ensures error message is centered on screen
  - Column with Arrangement.spacedBy provides consistent spacing between icon, message, and button
  - Avoided forward reference to PrimaryButton (US-027) by using Material3 Button directly
  - Preview with dark background (0xFF0D1B2A) validates appearance in VETTR dark theme
---

## US-026: Create EmptyStateView composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/EmptyStateView.kt @Composable function
- Displays Material Icon, title, subtitle text with centered layout
- Optional action button appears only when actionLabel and onAction are provided
- Parameters: icon: ImageVector, title: String, subtitle: String, actionLabel: String?, onAction: (() -> Unit)?
- Uses Box with fillMaxSize and Center alignment for centered empty state
- Column with Arrangement.spacedBy(Spacing.md) provides consistent spacing
- Icon size set to 64.dp with onSurfaceVariant tint
- Button uses VettrAccent background and white text for consistency with brand
- Added 2 @Preview composables: EmptyStateViewPreview (no action) and EmptyStateViewWithActionPreview (with action button)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/EmptyStateView.kt (created)
**Learnings for future iterations:**
  - EmptyStateView provides consistent empty state messaging across all screens (Watchlist, Alerts, Discovery, etc.)
  - Optional parameters (actionLabel, onAction) allow component to work with or without action button
  - Using Box with fillMaxSize and Center alignment ensures empty state is properly centered on screen
  - 64.dp icon size provides good visual prominence without overwhelming the message
  - TextAlign.Center on Text composables ensures multi-line text is center-aligned
  - Button with VettrAccent background maintains brand consistency across all action buttons
  - Preview composables with realistic use cases (watchlist, alerts) help validate component appearance
  - Conditional rendering (if actionLabel != null && onAction != null) ensures both parameters are provided before showing button
---
## US-027: Create PrimaryButton composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/PrimaryButton.kt @Composable function
- Implemented green background (VettrAccent), white text
- Parameters: text, onClick, isLoading, enabled, fullWidth
- Shows CircularProgressIndicator (20dp, white, 2dp stroke) when isLoading=true
- Disabled state uses 50% alpha transparency on container and content colors
- fullWidth parameter uses Modifier.fillMaxWidth() when true
- Added 4 @Preview composables: normal, loading, disabled, full-width states
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/PrimaryButton.kt (created)
**Learnings for future iterations:**
  - PrimaryButton provides consistent primary action styling across all screens (auth, profile actions, etc.)
  - Loading state disables button and replaces text with CircularProgressIndicator for better UX
  - Disabled state uses alpha transparency (0.5f) to visually indicate non-interactive state
  - fullWidth parameter allows flexible button sizing for different layout contexts
  - Modifier.then() conditional pattern allows optional modifier application (fillMaxWidth)
  - Button is disabled when either enabled=false OR isLoading=true to prevent duplicate actions
  - CircularProgressIndicator size (20dp) and strokeWidth (2dp) fit well within button height
  - Preview composables with realistic labels (Sign In, Continue) demonstrate button in context
---

## US-028: Create EventCard composable component
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created designsystem/component/EventCard.kt @Composable function
- Implemented Row layout with colored indicator dot (12.dp CircleShape) and content column
- Parameters: title, subtitle, date, indicatorColor (Color), onClick
- Uses Modifier.cardStyle() for consistent card styling with VettrCardBackground
- Uses Modifier.vettrPadding() for consistent padding
- Indicator dot positioned on left, vertically centered with content
- Column shows title (titleMedium), subtitle (bodyMedium), and date (labelSmall)
- Entire card is clickable with onClick callback for navigation to event details
- Added 3 @Preview composables: red indicator (SEC Investigation), yellow indicator (Insider Trading), green indicator (Price Target Upgrade)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/designsystem/component/EventCard.kt (created)
**Learnings for future iterations:**
  - EventCard provides consistent event/alert styling across Pulse and Alerts screens
  - Color-coded indicator dots enable quick visual identification of event severity/type
  - 12.dp CircleShape for indicator dot provides clear visual marker without overwhelming content
  - Using weight(1f) on content column allows proper text wrapping while keeping indicator dot fixed size
  - Three text levels (title, subtitle, date) provide hierarchical information display
  - Clickable modifier on entire card enables navigation to full event details
  - Preview composables with realistic Canadian stock events (SHOP, RY, ENB) demonstrate different indicator colors
  - Red/Yellow/Green color coding follows common severity conventions: red (critical/negative), yellow (warning/moderate), green (positive/informational)
---

## US-029: Add unit tests for design system components
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created app/src/test/java/com/vettr/android/designsystem/DesignSystemTest.kt with comprehensive unit tests
- Refactored VettrScoreView to extract testable functions: getScoreColor() and getScoreLabel()
- Refactored MetricCard to extract testable function: getChangeColor()
- Implemented tests for VettrScoreView color logic: score 85 -> green, 70 -> yellow, 50 -> orange, 30 -> red
- Implemented tests for VettrScoreView label logic: score 85 -> Strong Buy, 70 -> Buy, 50 -> Hold, 30 -> Caution
- Implemented tests for MetricCard change indicator: positive -> green, negative -> red, zero -> green
- Added edge case tests for boundary conditions (80, 60, 40, 0, 100, negative scores)
- All 24 tests pass successfully: ./gradlew testDebugUnitTest completes successfully
Files changed:
- app/src/test/java/com/vettr/android/designsystem/DesignSystemTest.kt (created with 24 unit tests)
- app/src/main/java/com/vettr/android/designsystem/component/VettrScoreView.kt (extracted helper functions)
- app/src/main/java/com/vettr/android/designsystem/component/MetricCard.kt (extracted helper function)
**Learnings for future iterations:**
  - To test Composable logic, extract business logic into pure functions that can be tested without UI framework
  - Helper functions can be package-private (no visibility modifier) to keep them internal to the module but accessible to tests
  - JUnit tests on Android use org.junit.Assert.assertEquals for assertions
  - Test boundary conditions thoroughly: edge cases at score thresholds (80, 60, 40) ensure correct range logic
  - Test directory structure: app/src/test/java/com/vettr/android/ mirrors main source structure
  - Refactoring for testability improves code architecture: separates presentation from business logic
  - Zero change (0.0) is treated as positive (green) per MetricCard implementation
---

## US-030: Create Stock Room entity
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/Stock.kt data class annotated with @Entity(tableName = "stocks")
- Added all required properties: id (String, @PrimaryKey), ticker, name, exchange, sector, marketCap, price, priceChange, vetrScore, isFavorite
- Added @ColumnInfo annotations for snake_case column names: market_cap, price_change, vetr_score, is_favorite
- Used UUID.randomUUID().toString() for default id generation
- Updated VettrDatabase.kt to include Stock entity in entities array
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/Stock.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (added Stock to entities)
**Learnings for future iterations:**
  - Room entities follow data class pattern with @Entity annotation and @PrimaryKey
  - @ColumnInfo annotation required for column names that don't match property names (e.g., camelCase to snake_case)
  - UUID.randomUUID().toString() provides unique primary key generation with default parameter
  - Boolean properties should have default values (isFavorite = false) for convenience
  - VettrDatabase must be updated to include all new entities in the entities array
  - Room compiles entity classes at build time with KSP annotation processor
---
## US-031: Create Filing Room entity
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/Filing.kt data class annotated with @Entity(tableName = "filings")
- Added all required properties: id (String, @PrimaryKey), stockId, type, title, date (Long), summary, isRead, isMaterial
- Added @ColumnInfo annotations for snake_case column names: stock_id, is_read, is_material
- Added @ForeignKey reference to Stock entity on stockId with CASCADE delete
- Added @Index on stock_id column to optimize foreign key queries and eliminate Room warning
- Updated VettrDatabase.kt to include Filing entity in entities array
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/Filing.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (added Filing to entities)
**Learnings for future iterations:**
  - Foreign key columns should have an index to optimize join queries and prevent full table scans
  - @Index annotation in @Entity declaration creates database index: indices = [Index(value = ["stock_id"])]
  - ForeignKey.CASCADE onDelete ensures filings are automatically deleted when parent stock is deleted
  - Date stored as Long (Unix timestamp) for efficient date/time storage and queries in Room
  - Boolean properties (isRead, isMaterial) should have default values (false) for convenience
  - Room KSP warns about unindexed foreign keys - adding index eliminates warning and improves performance
---
## US-032: Create Executive Room entity
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/Executive.kt entity with @Entity annotation and @PrimaryKey
- Added all required properties: id, stockId, name, title, yearsAtCompany, previousCompanies, education, specialization, socialLinkedIn, socialTwitter
- Added @ColumnInfo annotations for snake_case column names
- Added @ForeignKey reference to Stock entity with CASCADE delete
- Added @Index on stock_id column to optimize foreign key queries
- Created core/util/Converters.kt TypeConverter class for JSON serialization of List<String>
- Used Gson for JSON serialization/deserialization with TypeToken for List<String> type
- Updated VettrDatabase.kt to include Executive in entities array
- Added @TypeConverters(Converters::class) annotation to VettrDatabase
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/Executive.kt (created)
- app/src/main/java/com/vettr/android/core/util/Converters.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - TypeConverter pattern allows Room to handle complex types like List<String> by converting to/from JSON
  - Gson is already a project dependency (via Retrofit) and can be reused for TypeConverter serialization
  - TypeToken from Gson is required to deserialize generic types like List<String> correctly
  - @TypeConverters annotation must be added to the Database class to register converters
  - TypeConverter methods are called automatically by Room during database operations
  - Executive entity follows same pattern as Filing: ForeignKey to Stock with CASCADE delete and index on foreign key column
  - previousCompanies stored as JSON string allows flexible list storage without additional junction table
---
## US-033: Create User Room entity
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/VettrTier.kt enum class with FREE, PRO, PREMIUM tiers
- Each tier has watchlistLimit, pulseDelayHours, and syncIntervalHours properties
- Created core/model/User.kt data class annotated with @Entity(tableName = "users")
- User properties: id (String, @PrimaryKey), email, displayName, avatarUrl (nullable), tier (String), createdAt (Long)
- Added TypeConverter methods to core/util/Converters.kt for VettrTier enum (fromVettrTier/toVettrTier)
- Updated VettrDatabase.kt to include User entity in entities array
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/VettrTier.kt (created)
- app/src/main/java/com/vettr/android/core/model/User.kt (created)
- app/src/main/java/com/vettr/android/core/util/Converters.kt (updated with VettrTier converters)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (added User to entities)
**Learnings for future iterations:**
  - User entity depends on VettrTier enum, so enum must be created first
  - VettrTier stored as String in database using TypeConverter pattern (enum.name/valueOf)
  - TypeConverter pattern allows Room to handle custom types like enums by converting to/from database-compatible types
  - User avatarUrl is nullable (String?) since users may not have an avatar initially
  - VettrTier enum properties encapsulate tier-specific feature limits for easy access throughout the app
  - TypeConverter methods must be simple and symmetric: fromType converts to String, toType converts from String
---
## US-035: Create AlertType enum
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/AlertType.kt enum class with 5 alert type cases
- Added FINANCING, CONSOLIDATION, DRILL_RESULTS, MANAGEMENT_CHANGE, RED_FLAG cases
- Each case has displayName property for UI display (e.g., "Financing", "Drill Results")
- Each case has iconName property for Material icon reference (e.g., "account_balance", "construction")
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/AlertType.kt (created)
**Learnings for future iterations:**
  - AlertType enum provides categorization for different types of alerts in the VETTR platform
  - iconName property stores Material icon identifier strings for consistent icon usage across the app
  - Icon names use Material icon naming convention (snake_case): account_balance, merge_type, construction, swap_horiz, flag
  - displayName provides human-readable labels for UI display while maintaining code-friendly enum names
  - Enum pattern with properties is ideal for fixed sets of categories that need associated metadata
---
## US-036: Create AlertRule Room entity
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/AlertRule.kt data class annotated with @Entity(tableName = "alert_rules")
- Added all required properties: id (String, @PrimaryKey), userId, stockTicker, ruleType, triggerCondition, isActive, createdAt, lastTriggeredAt, frequency
- Added @ColumnInfo annotations for snake_case column names
- Added @Index annotations on userId and stockTicker columns for query optimization
- Updated VettrDatabase.kt to include AlertRule entity in entities array
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/AlertRule.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - AlertRule entity stores user-defined alert rules with conditions that trigger notifications
  - Multiple indices pattern: @Index annotations can be specified in array for multiple columns
  - Index on userId optimizes queries for fetching user's alert rules
  - Index on stockTicker optimizes queries for stock-specific alert rules
  - lastTriggeredAt is nullable (Long?) since rules may never have triggered
  - isActive default value (true) makes new rules active by default
  - Rule lifecycle: created (createdAt), activated/deactivated (isActive), triggered (lastTriggeredAt)
  - ruleType, triggerCondition, and frequency stored as String for flexibility (can be converted to enums later if needed)
---
## US-037: Create RedFlagHistory Room entity
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/RedFlagHistory.kt data class annotated with @Entity(tableName = "red_flag_history")
- Added all required properties: id (String, @PrimaryKey), stockTicker, flagType, severity, score (Double), description, detectedAt (Long), isAcknowledged (Boolean)
- Added @ColumnInfo annotations for snake_case column names: stock_ticker, flag_type, detected_at, is_acknowledged
- Added @Index on stock_ticker column to optimize queries for stock-specific red flags
- Updated VettrDatabase.kt to include RedFlagHistory entity in entities array
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/RedFlagHistory.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - RedFlagHistory entity stores detected red flags with severity levels for risk assessment
  - Index on stockTicker optimizes queries when fetching red flag history for specific stocks
  - isAcknowledged default value (false) allows tracking whether user has reviewed the red flag
  - severity, flagType, and score properties enable comprehensive risk analysis and categorization
  - detectedAt stored as Long (Unix timestamp) for efficient date/time storage and chronological queries
  - Pattern follows established entity conventions: UUID primary key, snake_case column names, proper indexing
---
## US-038: Create VetrScoreHistory Room entity
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/VetrScoreHistory.kt data class annotated with @Entity(tableName = "vetr_score_history")
- Added all required properties: id (String, @PrimaryKey), stockTicker, overallScore, pedigreeScore, filingVelocityScore, redFlagScore, growthScore, governanceScore, calculatedAt (Long)
- Added @ColumnInfo annotations for snake_case column names: stock_ticker, overall_score, pedigree_score, filing_velocity_score, red_flag_score, growth_score, governance_score, calculated_at
- Added @Index on stock_ticker column to optimize queries for stock-specific score history
- Updated VettrDatabase.kt to include VetrScoreHistory entity in entities array
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/VetrScoreHistory.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - VetrScoreHistory entity stores historical Vetr score breakdowns for tracking score changes over time
  - Score breakdown includes 6 component scores: pedigree, filing velocity, red flag, growth, governance, plus overall score
  - Index on stockTicker optimizes queries when fetching score history for specific stocks to visualize trends
  - calculatedAt stored as Long (Unix timestamp) for efficient chronological queries and time-series analysis
  - Pattern follows established entity conventions: UUID primary key, snake_case column names, proper indexing
  - This entity enables temporal analysis of stock scoring, allowing users to see how Vetr scores evolve
---
## US-039: Create SyncHistory Room entity
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/model/SyncHistory.kt data class annotated with @Entity(tableName = "sync_history")
- Added all required properties: id (String, @PrimaryKey), startedAt (Long), completedAt (Long?), duration (Long?), itemsSynced (Int), errors (String?), status (String)
- Added @ColumnInfo annotations for snake_case column names: started_at, completed_at, items_synced
- completedAt, duration, and errors are nullable since sync operations may be in progress or succeed without errors
- Updated VettrDatabase.kt to include SyncHistory entity in entities array
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/model/SyncHistory.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - SyncHistory entity provides logging for background sync operations performed by WorkManager
  - Nullable properties (completedAt, duration, errors) allow tracking of in-progress sync operations
  - startedAt stores when sync began, completedAt stores when it finished (null if in progress)
  - duration can be calculated (completedAt - startedAt) or stored for convenience
  - itemsSynced tracks number of items synced (stocks, filings, etc.) for monitoring data volume
  - errors field stores any error messages as String for debugging failed syncs
  - status field categorizes sync state (e.g., "success", "in_progress", "failed", "cancelled")
  - Pattern follows established entity conventions: UUID primary key, snake_case column names
---

## US-040: Create StockDao interface
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/StockDao.kt interface annotated with @Dao
- Implemented all required query methods: getAll(), getById(), getByTicker(), searchByName(), getFavorites()
- Implemented all required mutation methods: insert(), insertAll(), update(), delete()
- Used @Query annotations with Flow return types for reactive data observation
- Used @Insert with OnConflictStrategy.REPLACE for upsert behavior
- Used @Update and @Delete annotations for modification operations
- Added StockDao abstract method to VettrDatabase class
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/StockDao.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - StockDao provides database operations for Stock entities with reactive Flow return types
  - searchByName() uses LIKE query with wildcards to search both name and ticker fields
  - Flow return types enable reactive UI updates when database data changes
  - suspend functions required for insert/update/delete operations to run on background thread
  - OnConflictStrategy.REPLACE provides upsert behavior for insert operations
  - getFavorites() queries for is_favorite = 1 (Room uses 1 for true, 0 for false in SQLite)
  - DAO abstract methods must be added to RoomDatabase class to expose database operations
---
## US-041: Create FilingDao interface
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/FilingDao.kt interface annotated with @Dao
- Implemented query methods: getByStockId(), getLatest(), getById() with Flow return types
- All queries use ORDER BY date DESC for chronological ordering
- Implemented mutation methods: insert(), insertAll(), markAsRead()
- Used OnConflictStrategy.REPLACE for insert operations (upsert behavior)
- markAsRead() uses UPDATE query to set is_read = 1 for specific filing ID
- Added filingDao() abstract method to VettrDatabase class
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/FilingDao.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - FilingDao provides database operations for Filing entities with reactive Flow return types
  - ORDER BY date DESC ensures filings are returned in reverse chronological order (newest first)
  - getLatest() method uses LIMIT parameter for fetching N most recent filings across all stocks
  - getByStockId() filters filings for specific stock, useful for stock detail screen
  - markAsRead() implements partial update using UPDATE query instead of @Update annotation
  - Pattern follows established DAO conventions: Flow for queries, suspend for mutations, OnConflictStrategy.REPLACE for upserts
  - DAO abstract methods must be added to RoomDatabase class to expose database operations
---

## US-042: Create ExecutiveDao interface
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/ExecutiveDao.kt interface annotated with @Dao
- Implemented query methods: getByStockId(), searchByName(), getById() with Flow return types
- searchByName() uses LIKE query for searching executive names
- Implemented mutation methods: insert(), insertAll(), delete()
- Used OnConflictStrategy.REPLACE for insert operations (upsert behavior)
- Added executiveDao() abstract method to VettrDatabase class
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/ExecutiveDao.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - ExecutiveDao follows established DAO pattern with Flow for queries and suspend for mutations
  - searchByName() enables searching through executive names for discovery features
  - getByStockId() filters executives for specific stock, useful for Pedigree screen
  - OnConflictStrategy.REPLACE provides upsert behavior for insert operations
  - Pattern follows established conventions: Flow return types for reactive queries, suspend for mutations
  - DAO abstract methods must be added to RoomDatabase class to expose database operations
---

## US-043: Create AlertRuleDao interface
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/AlertRuleDao.kt interface annotated with @Dao
- Implemented query methods: getByUserId(), getByStockTicker(), getById(), getActive() with Flow return types
- Implemented mutation methods: insert(), update(), delete() with suspend modifiers
- Added getCountByUserId() method for rule limit enforcement (Free tier: 5 rules, Pro: 25, Premium: unlimited)
- Used OnConflictStrategy.REPLACE for insert operations (upsert behavior)
- getActive() queries for is_active = 1 to fetch only active alert rules
- Added alertRuleDao() abstract method to VettrDatabase class
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/AlertRuleDao.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - AlertRuleDao provides database operations for AlertRule entities with reactive Flow return types
  - getByUserId() enables fetching user-specific alert rules for alerts screen
  - getByStockTicker() enables fetching stock-specific rules for stock detail screen
  - getActive() filters for active rules (is_active = 1) that should trigger notifications
  - getCountByUserId() enables tier-based rule limit enforcement: Free (5), Pro (25), Premium (unlimited)
  - Pattern follows established DAO conventions: Flow for queries, suspend for mutations, OnConflictStrategy.REPLACE for upserts
  - DAO abstract methods must be added to RoomDatabase class to expose database operations
---
## US-044: Create RedFlagHistoryDao interface
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/RedFlagHistoryDao.kt interface annotated with @Dao
- Implemented query methods: getByStockTicker(ticker), getRecent(limit) with Flow return types
- Both queries use ORDER BY detected_at DESC for chronological ordering (newest first)
- Implemented mutation methods: insert(), insertAll(), acknowledge(id), acknowledgeAllForStock(ticker)
- Used OnConflictStrategy.REPLACE for insert operations (upsert behavior)
- acknowledge() and acknowledgeAllForStock() use UPDATE query to set is_acknowledged = 1
- Added redFlagHistoryDao() abstract method to VettrDatabase class
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/RedFlagHistoryDao.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - RedFlagHistoryDao provides database operations for RedFlagHistory entities with reactive Flow return types
  - getByStockTicker() filters red flags by stock ticker for stock detail screen, ordered by detection date
  - getRecent() fetches N most recent red flags across all stocks for Pulse screen red flag feed
  - acknowledge() and acknowledgeAllForStock() implement partial updates using UPDATE queries instead of @Update annotation
  - Pattern allows individual flag acknowledgment or bulk acknowledgment for all flags on a stock
  - Pattern follows established DAO conventions: Flow for queries, suspend for mutations, OnConflictStrategy.REPLACE for upserts
  - DAO abstract methods must be added to RoomDatabase class to expose database operations
---
## US-045: Create VetrScoreHistoryDao interface
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/VetrScoreHistoryDao.kt interface annotated with @Dao
- Implemented query methods: getByStockTicker(ticker, limit), getLatest(ticker) with Flow return types
- Both queries use ORDER BY calculated_at DESC for chronological ordering (newest first)
- getByStockTicker() uses LIMIT parameter to fetch N most recent score records for a stock
- getLatest() fetches the single most recent score record for a stock using LIMIT 1
- Implemented mutation methods: insert(), insertAll() with suspend modifiers
- Used OnConflictStrategy.REPLACE for insert operations (upsert behavior)
- Added vetrScoreHistoryDao() abstract method to VettrDatabase class
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/VetrScoreHistoryDao.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
**Learnings for future iterations:**
  - VetrScoreHistoryDao provides database operations for VetrScoreHistory entities with reactive Flow return types
  - getByStockTicker() enables fetching historical Vetr scores for trend visualization and time-series analysis
  - getLatest() provides quick access to the most recent score calculation for display on stock detail screen
  - Pattern allows limiting the number of historical records to prevent excessive memory usage for long histories
  - Pattern follows established DAO conventions: Flow for queries, suspend for mutations, OnConflictStrategy.REPLACE for upserts
  - ORDER BY calculated_at DESC ensures scores are returned in reverse chronological order for trend charts
  - DAO abstract methods must be added to RoomDatabase class to expose database operations
---

## US-046: Configure VettrDatabase with all entities and DAOs
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/UserDao.kt interface with CRUD operations for User entity
- Created core/data/local/SyncHistoryDao.kt interface with sync tracking operations
- Updated VettrDatabase.kt to include all 8 entities: Stock, Filing, Executive, User, AlertRule, RedFlagHistory, VetrScoreHistory, SyncHistory
- Removed PlaceholderEntity (no longer needed with real entities)
- Added abstract DAO accessors: userDao() and syncHistoryDao() to complete the set
- Verified TypeConverters(Converters::class) annotation for List<String> and VettrTier serialization
- Verified version = 1 and exportSchema = false
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/UserDao.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/SyncHistoryDao.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/VettrDatabase.kt (updated)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - VettrDatabase now complete with all 8 entities and 8 corresponding DAOs
  - UserDao includes getByEmail() for authentication flows and deleteAll() for logout
  - SyncHistoryDao includes updateCompletion() and updateErrors() for sync lifecycle tracking
  - SyncHistoryDao includes getInProgress() to check for ongoing syncs and prevent duplicate syncs
  - SyncHistoryDao includes deleteOlderThan() for cleanup of old sync logs
  - PlaceholderEntity was temporary scaffold - removed once real entities were added
  - Database follows single-responsibility principle: one DAO per entity for clean separation
  - All DAOs follow established pattern: Flow for queries, suspend for mutations, OnConflictStrategy.REPLACE for upserts
---
## US-047: Create DatabaseModule for Hilt DI
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/di/DatabaseModule.kt annotated with @Module @InstallIn(SingletonComponent::class)
- Added provideVettrDatabase() @Provides @Singleton method using Room.databaseBuilder()
- Added @Provides @Singleton methods for all 8 DAOs: StockDao, FilingDao, ExecutiveDao, UserDao, AlertRuleDao, RedFlagHistoryDao, VetrScoreHistoryDao, SyncHistoryDao
- Each DAO provider method accepts VettrDatabase as parameter and calls corresponding dao() method
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/di/DatabaseModule.kt (created)
**Learnings for future iterations:**
  - DatabaseModule follows standard Hilt pattern: @Module + @InstallIn(SingletonComponent::class) for app-level dependencies
  - Room database must be singleton to prevent multiple instances and ensure data consistency
  - DAO providers depend on VettrDatabase parameter, Hilt automatically resolves the dependency graph
  - @ApplicationContext qualifier required for Context parameter to ensure Application context, not Activity context
  - Room.databaseBuilder() pattern: context, database class, database name ("vettr-db")
  - Each DAO accessor method (database.stockDao(), etc.) returns DAO instance configured with the database
  - Providing DAOs separately from database enables flexible dependency injection in repositories and ViewModels
  - All 8 entities now have corresponding DAOs available for injection throughout the app
---

## US-048: Add model unit tests
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created app/src/test/java/com/vettr/android/core/model/ModelTest.kt with comprehensive unit tests
- Implemented 17 test cases covering Stock, VettrTier, and AlertType entities
- Test Stock entity creation with all properties and default values (UUID generation, isFavorite default)
- Test VettrTier enum properties for all three tiers (FREE, PRO, PREMIUM)
- Test AlertType enum properties for all five types (FINANCING, CONSOLIDATION, DRILL_RESULTS, MANAGEMENT_CHANGE, RED_FLAG)
- Added validation tests: tier boundary enforcement, pulse delay hierarchy, sync interval hierarchy
- Added uniqueness tests for AlertType displayName and iconName values
- All 42 unit tests pass successfully: ./gradlew testDebugUnitTest
Files changed:
- app/src/test/java/com/vettr/android/core/model/ModelTest.kt (created)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - Unit tests verify model creation and enum properties for business logic validation
  - Test actual implementation values, not assumed values - VettrTier values were different from initial assumptions
  - Use descriptive test names with backticks for readability: `VettrTier FREE has correct properties`
  - Test boundary conditions and hierarchies: tier limits increase with higher tiers, delays decrease with higher tiers
  - Test uniqueness constraints for enums to ensure no duplicate values
  - JUnit test structure: Given-When-Then pattern clarifies test intent and improves maintainability
  - ModelTest provides foundation for testing business logic without UI framework dependencies
---

## US-049: Create VettrApi interface with endpoints
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/remote/VettrApi.kt interface with all required endpoints
- Implemented GET /stocks endpoint to fetch all stocks (suspend fun getStocks(): List<StockDto>)
- Implemented GET /stocks/{ticker} endpoint to fetch stock by ticker (suspend fun getStock(@Path ticker: String): StockDto)
- Implemented GET /filings endpoint with stockId query parameter (suspend fun getFilings(@Query stockId: String): List<FilingDto>)
- Implemented POST /auth/login endpoint for authentication (suspend fun login(@Body request: LoginRequest): AuthResponse)
- Created StockDto.kt with all Stock properties mapped to JSON fields using @SerializedName
- Created FilingDto.kt with all Filing properties mapped to JSON fields using @SerializedName
- Created LoginRequest.kt with idToken and provider fields for Google Sign-In authentication
- Created AuthResponse.kt with accessToken, refreshToken, tokenType, expiresIn, and UserDto nested object
- Created UserDto.kt nested in AuthResponse for user profile information
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/remote/VettrApi.kt (created)
- app/src/main/java/com/vettr/android/core/data/remote/StockDto.kt (created)
- app/src/main/java/com/vettr/android/core/data/remote/FilingDto.kt (created)
- app/src/main/java/com/vettr/android/core/data/remote/LoginRequest.kt (created)
- app/src/main/java/com/vettr/android/core/data/remote/AuthResponse.kt (created)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - VettrApi interface defines all REST endpoints using Retrofit annotations (@GET, @POST, @Path, @Query, @Body)
  - All API methods are suspend functions for asynchronous execution with coroutines
  - DTOs use @SerializedName annotation to map JSON snake_case fields to Kotlin camelCase properties
  - LoginRequest uses idToken from Google Sign-In for OAuth authentication flow
  - AuthResponse includes nested UserDto for user profile information returned after successful login
  - Retrofit with Gson converter automatically serializes/deserializes between DTOs and JSON
  - DTOs should mirror Room entity structure but use Gson annotations instead of Room annotations
  - UserDto in AuthResponse provides user profile data that will be stored in User Room entity
---

## US-050: Create NetworkModule for Hilt DI
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/di/NetworkModule.kt annotated with @Module @InstallIn(SingletonComponent::class)
- Implemented provideOkHttpClient() @Provides @Singleton method with HttpLoggingInterceptor
- HttpLoggingInterceptor uses BODY level logging in debug builds, NONE in release builds
- Added connection, read, and write timeouts (30 seconds each) to OkHttpClient
- Implemented provideRetrofit() @Provides @Singleton method with base URL "https://api.vettr.com/"
- Added GsonConverterFactory to Retrofit for JSON serialization/deserialization
- Implemented provideVettrApi() @Provides @Singleton method to create VettrApi instance
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/di/NetworkModule.kt (created)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - NetworkModule follows standard Hilt pattern: @Module + @InstallIn(SingletonComponent::class) for app-level dependencies
  - HttpLoggingInterceptor.Level.BODY logs full request/response bodies in debug builds for debugging network calls
  - HttpLoggingInterceptor.Level.NONE disables logging in release builds to avoid performance overhead and security issues
  - BuildConfig.DEBUG flag enables conditional logic for debug vs release builds
  - OkHttpClient timeout configuration (connectTimeout, readTimeout, writeTimeout) prevents hanging network calls
  - Retrofit dependency injection: OkHttpClient → Retrofit → VettrApi with Hilt resolving the dependency graph
  - GsonConverterFactory.create() uses default Gson configuration for JSON serialization
  - BASE_URL constant allows easy configuration change for different environments (dev, staging, production)
  - retrofit.create(VettrApi::class.java) generates implementation of VettrApi interface at runtime
---

## US-051: Create StockRepository interface and implementation
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/repository/StockRepository.kt interface with methods: getStocks(), getStock(), searchStocks(), getFavorites(), toggleFavorite()
- Created core/data/repository/StockRepositoryImpl.kt implementing StockRepository with @Inject constructor
- StockRepositoryImpl delegates to StockDao for all operations
- Added toggleFavorite() method to StockDao using SQL UPDATE query with NOT operator for efficient toggle
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/repository/StockRepository.kt (created)
- app/src/main/java/com/vettr/android/core/data/repository/StockRepositoryImpl.kt (created)
- app/src/main/java/com/vettr/android/core/data/local/StockDao.kt (added toggleFavorite method)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - Repository pattern provides abstraction over data sources (DAO, API, cache) for testability and maintainability
  - StockRepositoryImpl uses @Inject constructor for Hilt dependency injection
  - Flow return types from DAO methods propagate through repository for reactive UI updates
  - toggleFavorite() implementation uses SQL UPDATE query with NOT operator for efficient boolean toggle
  - Added toggleFavorite() query to StockDao for efficient in-place update without fetching stock first
  - Repository layer enables future addition of remote data sources and caching strategies
  - All query methods return Flow for reactive data observation, mutation methods are suspend functions
---

## US-052: Create FilingRepository interface and implementation
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/repository/FilingRepository.kt interface with three methods
- getFilingsForStock(stockId: String): Flow<List<Filing>> for stock-specific filings
- getLatestFilings(limit: Int): Flow<List<Filing>> for recent filings across all stocks
- markAsRead(filingId: String) for updating filing read status
- Created core/data/repository/FilingRepositoryImpl.kt implementing FilingRepository
- FilingRepositoryImpl uses @Inject constructor with FilingDao dependency
- All methods delegate to FilingDao for data access
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/repository/FilingRepository.kt (created)
- app/src/main/java/com/vettr/android/core/data/repository/FilingRepositoryImpl.kt (created)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - FilingRepository follows same pattern as StockRepository: interface with implementation class
  - Repository pattern abstracts data sources (DAO) for testability and maintainability
  - All query methods return Flow for reactive UI updates, mutation methods are suspend functions
  - @Inject constructor enables Hilt dependency injection of FilingDao
  - Repository implementations delegate to DAO methods without additional business logic at this stage
  - Future enhancements could add remote data sources and caching strategies to repository layer
---

## US-053: Create RepositoryModule for Hilt DI
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/di/RepositoryModule.kt annotated with @Module @InstallIn(SingletonComponent::class)
- Used @Binds abstract methods to bind repository implementations to interfaces
- Bound StockRepositoryImpl to StockRepository with @Singleton scope
- Bound FilingRepositoryImpl to FilingRepository with @Singleton scope
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/di/RepositoryModule.kt (created)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - RepositoryModule uses @Binds annotation for interface-to-implementation binding (more efficient than @Provides)
  - @Binds methods must be abstract and take implementation as parameter, return interface type
  - @Binds is preferred over @Provides for simple interface delegation as it generates less code
  - Module must be abstract class when using @Binds annotations
  - All repository bindings use @Singleton scope to ensure single instance throughout app lifecycle
  - Hilt automatically resolves repository implementations when injecting repository interfaces into ViewModels
  - Pattern follows dependency inversion principle: high-level code depends on abstractions (interfaces), not implementations
---
## US-054: Create TokenManager with EncryptedSharedPreferences
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/TokenManager.kt class with @Inject constructor for Hilt DI
- Used EncryptedSharedPreferences with MasterKey.Builder and AES256_GCM key scheme
- Implemented secure token storage methods: saveToken(), getToken(), deleteToken()
- Implemented refresh token methods: saveRefreshToken(), getRefreshToken()
- Added clearAll() method for logging out and clearing all tokens
- Uses PrefKeyEncryptionScheme.AES256_SIV for key encryption and PrefValueEncryptionScheme.AES256_GCM for value encryption
- SharedPreferences file name: "vettr_secure_prefs"
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/TokenManager.kt (created)
**Learnings for future iterations:**
  - TokenManager provides secure storage for OAuth access tokens and refresh tokens using EncryptedSharedPreferences
  - MasterKey.Builder with AES256_GCM key scheme creates encryption key stored in Android Keystore
  - EncryptedSharedPreferences requires both key and value encryption schemes (AES256_SIV for keys, AES256_GCM for values)
  - @Singleton annotation ensures single instance of TokenManager throughout app lifecycle
  - @ApplicationContext qualifier ensures Application context is injected, not Activity context
  - clearAll() method enables complete token cleanup during logout flow
  - TokenManager follows constructor injection pattern for Hilt dependency injection
  - Encrypted storage protects sensitive authentication tokens from unauthorized access on device
---

## US-055: Create AuthRepository interface and implementation
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/repository/AuthRepository.kt interface with 6 authentication methods
- Methods: signInWithEmail(), signInWithGoogle(), signUp(), signOut(), getCurrentUser(), isAuthenticated()
- Created core/data/repository/AuthRepositoryImpl.kt with mock implementation using @Inject constructor
- Mock implementation stores auth state in-memory using MutableStateFlow<User?>
- Uses TokenManager for secure token storage with EncryptedSharedPreferences
- Automatically restores user session on init if token exists
- All authentication methods return Result<User> for error handling
- getCurrentUser() and isAuthenticated() return Flow for reactive UI updates
- Updated core/di/RepositoryModule.kt to bind AuthRepository with @Binds @Singleton
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/repository/AuthRepository.kt (created)
- app/src/main/java/com/vettr/android/core/data/repository/AuthRepositoryImpl.kt (created)
- app/src/main/java/com/vettr/android/core/di/RepositoryModule.kt (updated)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - AuthRepository follows repository pattern: interface with implementation class for testability
  - Mock implementation enables app development without backend API dependency
  - MutableStateFlow provides reactive state management for auth status and current user
  - TokenManager integration enables secure token persistence with EncryptedSharedPreferences
  - Result<T> type provides type-safe error handling for authentication operations
  - Flow return types enable reactive UI updates when auth state changes
  - Mock user creation uses VettrTier.FREE.name for tier field (String type in User entity)
  - Session restoration on init checks for existing token and recreates mock user
  - @Singleton scope ensures single AuthRepository instance throughout app lifecycle
  - Hilt @Binds annotation provides efficient interface-to-implementation binding
---

## US-056: Create email validation utility
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/util/Validators.kt with email and password validation functions
- isValidEmail() uses Android's Patterns.EMAIL_ADDRESS with regex fallback for unit tests
- Added consecutive dots check (..) to reject invalid email formats
- isValidPassword() validates min 8 chars, 1 uppercase, 1 lowercase, 1 digit
- Created ValidatorsTest.kt with 11 comprehensive unit tests
- Tests cover valid/invalid emails, valid/invalid passwords, edge cases, special characters
- All 11 tests pass successfully
- Build successful: ./gradlew testDebugUnitTest passes
Files changed:
- app/src/main/java/com/vettr/android/core/util/Validators.kt (created)
- app/src/test/java/com/vettr/android/core/util/ValidatorsTest.kt (created with 11 tests)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - Android Patterns.EMAIL_ADDRESS not available in unit test environment - requires regex fallback with try/catch
  - Email regex pattern must disallow consecutive dots (..) for RFC-compliant validation
  - Password validation should require lowercase in addition to uppercase and digit for better security
  - Simple consecutive dots check (email.contains("..")) is more maintainable than complex regex
  - Comprehensive test coverage includes edge cases: blank strings, boundary conditions, special characters
  - Validators object provides reusable validation logic for auth screens and forms throughout the app
---
## US-057: Create SeedDataService
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created core/data/local/SeedDataService.kt with @Inject constructor and @Singleton scope
- SeedDataService takes StockDao, FilingDao, and ExecutiveDao as dependencies
- Implemented seedAllData() method - placeholder for actual seed data (to be added in US-058 and US-059)
- Implemented isSeedComplete() method using DataStore preferences to check seed status
- Implemented markSeedComplete() method using DataStore preferences to mark seed as complete
- Used DataStore preferences extension (preferencesDataStore) with "seed_prefs" name
- Used booleanPreferencesKey "seed_complete" for tracking seed completion status
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/SeedDataService.kt (created)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - DataStore preferences pattern uses Context extension: `private val Context.dataStore by preferencesDataStore(name = "...")`
  - DataStore preferences accessed via context.dataStore.data flow with map and first() for synchronous reads
  - DataStore preferences updated via context.dataStore.edit lambda for writes
  - booleanPreferencesKey creates typed key for Boolean preferences
  - @ApplicationContext qualifier ensures Application context injection for DataStore (not Activity context)
  - SeedDataService is @Singleton to ensure consistent seed state throughout app lifecycle
  - Flow.map() transforms preferences to specific value, Flow.first() suspends and returns first emission
  - DataStore preferences provide type-safe, asynchronous alternative to SharedPreferences
  - seedAllData() will be populated with actual stock/filing/executive data in subsequent stories (US-058, US-059)
---

## US-058: Add 25 pilot stocks seed data
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Implemented seedStocks() method in SeedDataService with 25 Canadian stocks
- Included all 23 required stocks from acceptance criteria: BTO.TO, FOM.V, AMC.V, IE.TO, LAAC.TO, DML.TO, GMIN.TO, SOIL.V, TVE.TO, CJ.TO, GRN.TO, NPI.TO, DCBO.TO, LSPD.TO, DND.TO, QUIS.V, PNG.V, ENGH.TO, ACT.CSE, PLUR.V, PAID.CSE, NDA.V, NTAR.CSE
- Added 2 additional stocks to reach 25 total: BIR.TO (Birchcliff Energy), VET.TO (Vermilion Energy)
- Stock data includes realistic properties: ticker, name, exchange, sector, marketCap, price, priceChange, vetrScore
- VETR Scores distributed across range (30-95): 5 Strong Buy (80-90), 9 Buy (62-75), 7 Hold (45-53), 4 Caution (32-38)
- Sectors: Mining (9), Technology (8), Energy (7), Agriculture (1)
- Exchanges: TSX (11), TSXV (10), CSE (4)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/SeedDataService.kt (added seedStocks method and 25 stocks)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - Acceptance criteria listed 23 stocks but title said "25 pilot stocks" - added 2 more Canadian stocks to meet the 25 target
  - Used realistic Canadian stock data with appropriate exchanges (TSX, TSXV, CSE) and sectors
  - VETR Score distribution should reflect mix of investment ratings: Strong Buy (>80), Buy (60-79), Hold (40-59), Caution (<40)
  - Market caps and prices should be realistic for Canadian micro-cap and small-cap stocks
  - Price changes (positive/negative) add realism to stock data for UI testing
  - All 25 stocks have unique tickers to prevent Room database conflicts
  - seedStocks() is called from seedAllData() which will also seed filings and executives in US-059
---
## US-059: Add sample filings and executives seed data
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Implemented seedFilings() method with 3-5 filings per stock
- Filing types include MD&A, Press Release, and Financial Statements with realistic titles and summaries
- Filing dates randomly distributed over last 6 months (1-180 days ago)
- Implemented seedExecutives() method with 2-4 executives per stock
- Executive roles include CEO, CFO, VP Exploration/CTO/VP Operations, and VP Corporate Development
- Executive data includes realistic names, titles, tenure (yearsAtCompany), previous companies (JSON-serialized), education, and specializations
- Added helper functions: getPressReleaseTitle(), getPressReleaseSummary(), getExecutiveName(), getPreviousCompanies(), getEducation(), getSpecialization()
- Sector-specific content generation for Mining, Energy, Technology, and Agriculture sectors
- Previous companies list serialized to JSON using Gson for storage in Room database
- Updated seedAllData() to call seedFilings() and seedExecutives() with stock data
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/core/data/local/SeedDataService.kt (added 249 lines)
**Learnings for future iterations:**
  - Double ranges don't have random() extension in Kotlin - use Random.nextDouble(from, until) instead
  - Filing stockId must match Stock.id (UUID), not ticker, due to foreign key relationship
  - Executive previousCompanies stored as JSON string using Gson serialization for Room database compatibility
  - Sector-specific content generation improves realism of seed data for different industries
  - Random filing dates distributed over 6 months provide realistic temporal variety for testing
  - Executive tenure ranges should be realistic: CEO (3-15 years), CFO (2-12 years), VPs (1.5-10 years)
  - Helper functions for name/company/education generation improve code maintainability and variety
  - Gson is already available as project dependency through Retrofit, can be reused for JSON serialization
---
## US-060: Seed data on first launch
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Updated VettrApp.kt to implement seed check and data loading on first launch
- Added @Inject lateinit var seedDataService: SeedDataService for Hilt dependency injection
- Created applicationScope coroutine scope with SupervisorJob and Dispatchers.IO for background seeding
- Implemented onCreate() override to check isSeedComplete() and call seedAllData() if needed
- Marks seed as complete after seeding finishes to prevent re-seeding on subsequent launches
- SeedDataService automatically provided by Hilt via @Singleton and @Inject constructor annotations
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/VettrApp.kt (updated with seed logic)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - Application class can use @Inject lateinit var for Hilt dependency injection without @AndroidEntryPoint
  - SupervisorJob + Dispatchers.IO creates coroutine scope for background work that survives child coroutine failures
  - DataStore preferences (used by SeedDataService) provide type-safe async persistence for seed completion flag
  - SeedDataService doesn't need explicit Hilt module binding - @Singleton + @Inject constructor enables automatic provision
  - Application.onCreate() runs before any Activity, making it ideal for one-time initialization like database seeding
  - Coroutine scope tied to Application lifecycle ensures seed operation completes even if user navigates away
  - Seed check prevents duplicate seeding on subsequent app launches by checking DataStore flag
---

## US-061: Add seed data unit tests
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created app/src/test/java/com/vettr/android/core/data/SeedDataServiceTest.kt with comprehensive unit tests
- Added MockK version 1.13.13 to gradle/libs.versions.toml for mocking in unit tests
- Added kotlinx-coroutines-test dependency to gradle/libs.versions.toml for testing coroutines
- Updated app/build.gradle.kts with testImplementation dependencies: mockk and kotlinx-coroutines-test
- Implemented 6 test cases covering seed data integrity:
  1. `25 stocks are generated with valid fields` - verifies stock count, non-null/non-empty fields, valid exchanges (TSX/TSXV/CSE), positive prices and market caps
  2. `VETR Scores are in valid range 0-100` - verifies all scores are between 0-100 and there's score distribution
  3. `Filings have required fields - title, date, summary` - verifies 75-125 filings generated (3-5 per stock), all have required fields, dates are in the past
  4. `All stocks have unique tickers` - verifies no duplicate tickers in seed data
  5. `All stocks have unique IDs` - verifies all stock IDs are unique (UUID collision check)
  6. `Executives are generated for each stock` - verifies 50-100 executives (2-4 per stock), all have valid fields
- Used MockK to mock DAOs (StockDao, FilingDao, ExecutiveDao) and capture inserted data for validation
- Used slot() pattern to capture List arguments passed to DAO insert methods
- All 6 tests pass successfully: ./gradlew testDebugUnitTest
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/test/java/com/vettr/android/core/data/SeedDataServiceTest.kt (created with 242 lines)
- gradle/libs.versions.toml (added mockk and kotlinx-coroutines-test)
- app/build.gradle.kts (added test dependencies)
- scripts/ralph/prd.json (updated passes to true)
**Learnings for future iterations:**
  - MockK is essential for unit testing Android components - enables mocking of DAOs without database dependency
  - slot() pattern in MockK captures method arguments for verification: `val slot = slot<List<Stock>>()` + `coEvery { dao.insert(capture(slot)) }`
  - MockK uses `coEvery` for suspend functions and `coVerify` for verification of suspend function calls
  - MockK `relaxed = true` parameter creates relaxed mock that returns default values for all methods
  - Unit tests should verify business logic without database/network dependencies
  - Comprehensive test coverage includes: required fields, ranges, counts, uniqueness, distribution
  - Test names with backticks allow descriptive names: `Filings have required fields - title, date, summary`
  - kotlinx-coroutines-test provides runBlocking for testing suspend functions synchronously
  - Test results are in XML format at app/build/test-results/testDebugUnitTest/*.xml
  - Adding new test dependencies requires updating both libs.versions.toml and build.gradle.kts
---

## US-062: Create AuthViewModel with Hilt
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created feature/auth/AuthViewModel.kt with @HiltViewModel annotation
- Injected AuthRepository via @Inject constructor
- Implemented StateFlow-based UI state with AuthUiState data class
- Added StateFlow properties: email, password, isLoading, errorMessage, isAuthenticated
- Implemented methods: signInWithEmail(), signInWithGoogle(idToken), signUp(), clearError()
- Added helper methods: onEmailChange(), onPasswordChange() for UI state updates
- ViewModel observes authRepository.isAuthenticated() flow in init block
- All methods use viewModelScope.launch for coroutines
- Error handling with Result.fold() pattern for repository responses
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - ViewModels follow pattern: @HiltViewModel + @Inject constructor + StateFlow
  - Use viewModelScope.launch for all coroutine operations
  - Repository methods return Result<T>, handle with fold(onSuccess, onFailure)
  - UI state should be a data class with all screen state properties
  - Use MutableStateFlow internally, expose as StateFlow with asStateFlow()
  - Update state immutably with _uiState.update { it.copy(...) }
  - Validation logic (e.g., blank email/password) should happen in ViewModel
---

## US-063: Create WelcomeScreen composable
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created feature/auth/WelcomeScreen.kt with @Composable function
- Implemented VETTR logo placeholder (green box with "V")
- Added dog mascot placeholder (🐕 emoji in surfaceVariant box)
- Included tagline "Smart Investing for Canadians"
- Added "Get Started" PrimaryButton with fullWidth
- Added "Log In" TextButton for secondary navigation
- Added @Preview with VettrTheme and dark background (0xFF0D1B2A)
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - PrimaryButton already has horizontal padding, so set modifier padding to 0.dp when using fullWidth
  - Use MaterialTheme.colorScheme for colors, not hardcoded values
  - TextButton content should use MaterialTheme.typography and colorScheme.primary for consistency
  - Dog emoji (🐕) used as placeholder for mascot illustration
  - Layout uses SpaceBetween arrangement for proper spacing of logo, mascot, and action buttons
---

## US-064: Create LoginScreen composable
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created LoginScreen.kt @Composable with email/password OutlinedTextFields
- Added Google Sign-In outlined button and Log In PrimaryButton
- Integrated with AuthViewModel using hiltViewModel() and collectAsStateWithLifecycle()
- Email field with KeyboardType.Email
- Password field with visibility toggle icon (show/hide password)
- Error message display from viewModel.errorMessage
- "Don't have an account? Sign Up" link at bottom
- Added @Preview composables
- Build passes: ./gradlew assembleDebug successful
**Learnings for future iterations:**
  - OutlinedTextField colors need explicit theming for dark mode compatibility
  - Password visibility toggle uses Icons.Default.Visibility/VisibilityOff
  - Use collectAsStateWithLifecycle() for state collection in Compose screens
  - TextButton with custom text color for links
  - OutlinedButton for secondary actions like Google Sign-In
---

## US-065: Create SignUpScreen composable
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created SignUpScreen.kt in feature/auth/ package
- Implemented email, password, and confirm password fields with OutlinedTextField
- Added field validation for email format using android.util.Patterns.EMAIL_ADDRESS
- Added password matching validation between password and confirmPassword fields
- Integrated with AuthViewModel using hiltViewModel() and collectAsStateWithLifecycle()
- Added visibility toggles for both password fields using Icons.Default.Visibility/VisibilityOff
- Included Google Sign-In button (OutlinedButton) and Sign Up PrimaryButton
- Added "Already have an account? Log In" clickable TextButton at bottom
- Added @Preview with VettrTheme and dark background (0xFF0D1B2A)
- All acceptance criteria met: ./gradlew assembleDebug succeeds

**Learnings for future iterations:**
- SignUpScreen follows same pattern as LoginScreen with local state for form fields and validation
- Field validation is done locally before calling ViewModel methods
- Error states are shown using isError and supportingText parameters on OutlinedTextField
- Email validation uses Android's built-in Patterns.EMAIL_ADDRESS matcher
- Password visibility is managed with local mutableStateOf and IconButton toggles
- The screen integrates with existing AuthViewModel's signUp(), onEmailChange(), and onPasswordChange() methods
- Preview uses same dark theme background as other auth screens for consistency
---

## US-066: Set up Navigation Compose with auth routing
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created feature/main/VettrNavHost.kt with auth and main navigation graphs
- Auth graph includes: Welcome, Login, SignUp screens with proper navigation
- Main graph includes: placeholder for MainScreen (to be implemented in US-067)
- Observes AuthRepository.isAuthenticated() flow to automatically navigate between auth/main
- Uses LaunchedEffect to handle auth state changes and navigate accordingly
- Wired VettrNavHost into MainActivity.setContent() with AuthRepository injection
- Files changed:
  - Created: app/src/main/java/com/vettr/android/feature/main/VettrNavHost.kt
  - Modified: app/src/main/java/com/vettr/android/MainActivity.kt
- Build verification: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Navigation Compose: Use nested navigation graphs (navigation { }) for logical grouping
  - Auth flow: LaunchedEffect(isAuthenticated) observes auth state and navigates automatically
  - Screen parameters: Match existing screen composable signatures (onSignUpClick, onLoginClick)
  - Navigation on auth success: Remove popUpTo in screen callbacks, let LaunchedEffect handle it
  - MainActivity injection: Use @Inject lateinit var for repository injection in Activities
  - Sealed classes for routes provide type-safe navigation
---

## US-067: Create MainScreen with bottom navigation
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created feature/main/MainScreen.kt with NavigationBar containing 5 tabs
- Implemented BottomNavDestination sealed class for type-safe navigation routes
- Added Material icons: TrendingUp (Pulse), Explore (Discovery), List (Stocks), Notifications (Alerts), Person (Profile)
- Used VettrAccent color for selected tab tint per design system
- Integrated nested NavHost within MainScreen for tab-based navigation
- Updated VettrNavHost.kt to use MainScreen instead of placeholder
- Added MainScreenPreview @Composable for preview support
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Use AutoMirrored versions of icons (Icons.AutoMirrored.Filled.TrendingUp, Icons.AutoMirrored.Filled.List) to avoid deprecation warnings
  - NavigationBarItemDefaults.colors() allows customization of selected/unselected icon and text colors
  - Use rememberSaveable for bottom nav state to preserve across configuration changes
  - NavHost inside Scaffold with bottom bar creates proper nested navigation structure
  - Set launchSingleTop = true and restoreState = true in navigation for proper back stack behavior
  - Placeholder screens created for each tab (Pulse, Discovery, Stocks, Alerts, Profile) to be replaced in future stories
---

## US-068: Create placeholder screens for each tab
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created PulseScreen.kt in feature/pulse/ with Scaffold and TopAppBar
- Created DiscoveryScreen.kt in feature/discovery/ with Scaffold and TopAppBar
- Created StocksScreen.kt in feature/stockdetail/ with Scaffold and TopAppBar
- Created AlertsScreen.kt in feature/alerts/ with Scaffold and TopAppBar
- Created ProfileScreen.kt in feature/profile/ with Scaffold and TopAppBar
- Updated MainScreen.kt to import and use new screen composables instead of inline PlaceholderScreen
- Removed PlaceholderScreen composable as it's no longer needed
- Each screen displays centered title text matching its navigation label
- All screens include @Preview composables for design verification
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Feature screens should be in their respective feature packages, not inline in MainScreen
  - Each screen follows consistent pattern: Scaffold with TopAppBar and centered content
  - @OptIn(ExperimentalMaterial3Api::class) needed for TopAppBar
  - Import cleanup: removed unused Box and Alignment imports from MainScreen after removing PlaceholderScreen
  - Screen composables accept Modifier parameter for flexible layout integration
---

## US-069: Style bottom navigation bar
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Updated NavigationBar styling in MainScreen.kt with VETTR dark theme colors
- Set containerColor to VettrNavy (#0D1B2A) for consistent dark background
- Set contentColor to VettrTextSecondary for default text color
- Added tonalElevation of 8.dp to create subtle shadow/elevation effect
- Updated NavigationBarItem colors:
  - selectedIconColor: VettrAccent (green #00C853)
  - selectedTextColor: VettrAccent
  - unselectedIconColor: VettrTextSecondary (gray #A0A0A0)
  - unselectedTextColor: VettrTextSecondary
  - indicatorColor: VettrNavy (matches background for subtle selection)
- Added imports for VettrNavy, VettrTextSecondary, and dp unit
- Build successful: ./gradlew assembleDebug passes

Files changed:
- app/src/main/java/com/vettr/android/feature/main/MainScreen.kt

**Learnings for future iterations:**
- NavigationBar uses tonalElevation parameter for shadow/elevation (not shadowElevation)
- Setting indicatorColor to match the background creates a more subtle selected state
- All navigation bar colors should reference design system tokens (VettrNavy, VettrAccent, VettrTextSecondary)
- The dark theme aesthetic requires VettrNavy (#0D1B2A) for navigation bar background
- Material 3 NavigationBar has containerColor and contentColor for theming
---

## US-070: Create PulseViewModel with Hilt
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Created PulseViewModel.kt in feature/pulse/ with @HiltViewModel annotation
- Injected StockRepository and FilingRepository via @Inject constructor
- Implemented StateFlow properties:
  - stocks: StateFlow<List<Stock>> for stock data
  - filings: StateFlow<List<Filing>> for filing data
  - isLoading: StateFlow<Boolean> for loading state
  - errorMessage: StateFlow<String?> for error handling
- Implemented loadData() method that:
  - Collects stocks from stockRepository.getStocks()
  - Collects latest 10 filings from filingRepository.getLatestFilings(10)
  - Uses viewModelScope.launch for coroutines
  - Handles errors with try/catch and updates errorMessage
  - Updates isLoading state appropriately
- Implemented refresh() method that calls loadData()
- Called loadData() in init block to auto-load data on ViewModel creation
- Build successful: ./gradlew assembleDebug passes

Files changed:
- app/src/main/java/com/vettr/android/feature/pulse/PulseViewModel.kt (new file)

**Learnings for future iterations:**
- ViewModels use @HiltViewModel with @Inject constructor for dependency injection
- StateFlow pattern: private MutableStateFlow with public StateFlow via asStateFlow()
- Use viewModelScope.launch for coroutines in ViewModels (automatically cancelled when ViewModel cleared)
- Repository methods return Flow<T>, collect them with .collect { } in viewModelScope
- Error handling with .catch {} operator on flows to gracefully handle failures
- init block is ideal for auto-loading data when ViewModel is first created
- Separate launch blocks for independent data streams allow parallel collection
- Always expose immutable StateFlow to UI, keep MutableStateFlow private
---

## US-071: Build PulseScreen with Market Overview section
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Updated PulseScreen.kt to use PulseViewModel via hiltViewModel()
- Added SearchBarView at top with notification bell IconButton
- Added Market Overview section with SectionHeader component
- Created horizontal LazyRow with 3 MetricCards for TSX, S&P 500, and NASDAQ
- Each MetricCard displays mock index value and percentage change (+/-)
- Used existing design system components: SearchBarView, MetricCard, SectionHeader
- Applied proper spacing using Spacing design tokens (md, lg, sm)
- Updated preview with navy background color (0xFF0D1B2A)
- Build successful: ./gradlew assembleDebug passes
Files changed:
- app/src/main/java/com/vettr/android/feature/pulse/PulseScreen.kt
**Learnings for future iterations:**
  - All required components (SearchBarView, MetricCard, SectionHeader) already existed in designsystem/component/
  - MetricCard component uses cardStyle() and vettrPadding() modifier extensions for consistent styling
  - LazyRow with contentPadding should use PaddingValues(horizontal = 0.dp) to avoid extra padding
  - MetricCard width should be explicitly set (150.dp) for horizontal scrolling cards
  - SearchBarView requires query state management in the composable
  - PulseViewModel was already created in US-070 and properly uses @HiltViewModel pattern
  - Icons.Default.Notifications is available in material.icons.filled package
  - collectAsStateWithLifecycle() should be used for collecting StateFlow in Compose
---

## US-072: Add Strategic Events section to PulseScreen
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Added Strategic Events section to PulseScreen below Market Overview section
- Used existing EventCard component with 3 sample events
- Sample events included:
  - Discovery Drill Hit (green indicator) - BBB.V gold discovery
  - Red Flag Alert (red indicator) - XYZ.TO insider selling
  - New Financing (yellow indicator) - ABC.V $10M private placement
- Added imports: LazyColumn, EventCard, VettrGreen, VettrRed, VettrYellow
- Used Column with vertical spacing instead of LazyColumn for better scrolling in nested scroll context
- Build verified successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - EventCard component was already created in previous stories - reused successfully
  - Used Column instead of LazyColumn for events list since PulseScreen already has verticalScroll on parent
  - LazyColumn cannot be nested inside verticalScroll - use Column with spacedBy for vertical lists in scrollable parents
  - Color tokens (VettrGreen, VettrRed, VettrYellow) already defined in designsystem/theme/Color.kt
  - SectionHeader composable provides consistent section titles across the app
---

## US-073: Add Trending Stocks section to PulseScreen
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Added Trending Stocks section to PulseScreen.kt after Strategic Events section
- Implemented horizontal LazyRow with StockRowView composables
- Shows first 6 stocks from PulseViewModel.stocks using .take(6)
- Added SectionHeader with "See All" button (placeholder navigation)
- Each stock displays ticker, company name, price, and price change
- Stock rows are 280dp wide for proper horizontal scrolling
- Clicking a stock has placeholder navigation to StockDetailScreen
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - StockRowView component already existed in designsystem/component/
  - Used LazyRow with items() extension function for efficient horizontal list
  - SectionHeader accepts optional onSeeAllClick callback for "See All" button
  - Used .take(6) on stocks list to show only 5-6 trending stocks
  - StockRowView requires explicit width modifier (280.dp) when used in horizontal LazyRow
  - Logo URL currently null as Stock model doesn't have logo field yet
---

## US-074: Add loading, error, and empty states to PulseScreen
Status: ✅ COMPLETE
Date: 2026-02-07
Details:
- Added LoadingView when isLoading is true and stocks list is empty (PulseScreen.kt:84-90)
- Added ErrorView with retry button when errorMessage is not null (PulseScreen.kt:74-81)
- Added EmptyStateView when no data is available after loading (PulseScreen.kt:93-103)
- Implemented pull-to-refresh using Material 3's PullToRefreshBox (PulseScreen.kt:104-110)
- All state collected using collectAsStateWithLifecycle() (PulseScreen.kt:63-66)
- Build successful: ./gradlew assembleDebug passes
**Learnings for future iterations:**
  - Material 3 uses PullToRefreshBox (requires @OptIn(ExperimentalMaterial3Api::class))
  - EmptyStateView component doesn't have a modifier parameter - wrap in Box if padding needed
  - State handling should check isLoading with data emptiness for proper loading state display
  - Early returns with return@Scaffold keep UI state logic clean and readable
  - Always import Box when wrapping components that don't accept modifiers
---
